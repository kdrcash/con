<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pro-Consulting Lab (HTML/JS)</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- âœ… SheetJS (Excel Export) -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

  <style>
    .sticky-col-1 { left: 0; z-index: 20; box-shadow: 2px 0 5px -2px rgba(0,0,0,0.1); }
    .sticky-col-2 { left: 40px; z-index: 20; box-shadow: 2px 0 5px -2px rgba(0,0,0,0.1); }
    .table-container { overflow-x: auto; }
    .sticky-col { position: sticky; }
  </style>

  <script>
    /* =========================
       1) Utils
    ========================= */
    const toNum = (v) => {
      if (v === null || v === undefined) return 0;
      const s = String(v).replace(/[,\s]/g, '');
      const n = Number(s);
      return Number.isFinite(n) ? n : 0;
    };

    const formatCurrency = (val) =>
      new Intl.NumberFormat('ko-KR', { style: 'currency', currency: 'KRW' }).format(Math.round(val || 0));

    const formatCompactCurrency = (val) => {
      const n = Math.round(val || 0);
      if (!n) return '0';
      return new Intl.NumberFormat('ko-KR', { style: 'decimal', maximumFractionDigits: 0 }).format(n);
    };

    const formatRate1 = (v) => {
      const n = Number(v);
      return (Number.isFinite(n) ? n : 0).toFixed(1);
    };

    // âœ… ì…ë ¥ ì¤‘ì—ë„ ì½¤ë§ˆ ìë™ í‘œê¸° + ì»¤ì„œ ìœ„ì¹˜ ìµœëŒ€í•œ ìœ ì§€
    const formatNumberInputWithComma = (inputEl) => {
      const raw = inputEl.value;

      // ìˆ«ì/ì‰¼í‘œ ì™¸ ì œê±° (ìŒìˆ˜/ì†Œìˆ˜ í•„ìš” ì—†ìœ¼ë©´ ì•„ë˜ ì •ê·œì‹ ìœ ì§€)
      const digitsOnly = raw.replace(/[^\d]/g, '');
      // ë¹ˆ ê°’ í—ˆìš©
      if (!digitsOnly) {
        inputEl.value = '';
        return;
      }

      const beforeCaret = raw.slice(0, inputEl.selectionStart || 0);
      const beforeDigitsCount = beforeCaret.replace(/[^\d]/g, '').length;

      const formatted = Number(digitsOnly).toLocaleString('ko-KR');
      inputEl.value = formatted;

      // caret ë³µì›: formattedì—ì„œ beforeDigitsCountë²ˆì§¸ ìˆ«ì ë’¤ë¡œ ì´ë™
      let pos = 0;
      let digitSeen = 0;
      while (pos < formatted.length) {
        if (/\d/.test(formatted[pos])) digitSeen++;
        if (digitSeen >= beforeDigitsCount) { pos++; break; }
        pos++;
      }
      inputEl.setSelectionRange(pos, pos);
    };

    /* =========================
       2) Tax / Solver
    ========================= */
    const calculateSimulatedIncomeTax = (taxableIncome) => {
      const tb = Math.max(0, Math.floor(taxableIncome));
      let tax = 0;
      if (tb <= 14_000_000) tax = tb * 0.06;
      else if (tb <= 50_000_000) tax = tb * 0.15 - 1_260_000;
      else if (tb <= 88_000_000) tax = tb * 0.24 - 5_760_000;
      else if (tb <= 150_000_000) tax = tb * 0.35 - 15_440_000;
      else if (tb <= 300_000_000) tax = tb * 0.38 - 19_940_000;
      else if (tb <= 500_000_000) tax = tb * 0.40 - 25_940_000;
      else if (tb <= 1_000_000_000) tax = tb * 0.42 - 35_940_000;
      else tax = tb * 0.45 - 65_940_000;
      return Math.max(0, Math.floor(tax));
    };

    const solveTNI = (func, targetValue) => {
      let low = 0;
      let high = 100_000_000_000;
      let mid = 0;

      for (let i = 0; i < 110; i++) {
        mid = (low + high) / 2;
        const result = func(mid);
        if (Math.abs(result - targetValue) < 10) break;
        if (result < targetValue) low = mid;
        else high = mid;
      }
      return mid;
    };

    /* =========================
       3) Core Calculation (ìˆœìˆ˜í•¨ìˆ˜)
    ========================= */
    const calculateResults = (inputs, mode) => {
      const annualRevenue = toNum(inputs.annualRevenue);
      const monthlyExpense = toNum(inputs.monthlyExpense);
      const monthlyRequiredExpense = toNum(inputs.monthlyRequiredExpense);
      const targetProfitRate = toNum(inputs.targetProfitRate);
      const afterTaxNetIncome = toNum(inputs.afterTaxNetIncome);

      const annualExp = monthlyExpense * 12;
      const annualReqExpInput = monthlyRequiredExpense * 12;
      const annualAfterTaxNetIncome = afterTaxNetIncome * 12;

      let calculatedAnnualRevenue = annualRevenue;
      let calculatedMonthlyRequiredExpense = monthlyRequiredExpense;
      let calculatedTargetProfitRate = targetProfitRate;

      let actualNetIncome = 0; // ANI = AR - ì—°ì§€ì¶œ
      let taxBaseIncome = 0;   // TNI

      switch (mode) {
        case 'mode1': {
          const totalExpenseInput = annualExp + annualReqExpInput;
          const profitRatioComplement = (1 - targetProfitRate / 100);

          calculatedAnnualRevenue = (profitRatioComplement > 0 && targetProfitRate < 100)
            ? (totalExpenseInput / profitRatioComplement)
            : 0;

          actualNetIncome = calculatedAnnualRevenue - annualExp;
          taxBaseIncome = actualNetIncome - annualReqExpInput;

          calculatedMonthlyRequiredExpense = monthlyRequiredExpense;
          calculatedTargetProfitRate = targetProfitRate;
          break;
        }

        case 'mode2': {
          const funcMode2 = (tni) => {
            const tax = calculateSimulatedIncomeTax(tni);
            const ani = tni + annualReqExpInput;
            return ani - (tax * 1.1);
          };

          taxBaseIncome = solveTNI(funcMode2, annualAfterTaxNetIncome);
          calculatedAnnualRevenue = taxBaseIncome + annualReqExpInput + annualExp;

          actualNetIncome = calculatedAnnualRevenue - annualExp;
          calculatedTargetProfitRate = (calculatedAnnualRevenue !== 0)
            ? (taxBaseIncome / calculatedAnnualRevenue) * 100
            : 0;

          calculatedMonthlyRequiredExpense = monthlyRequiredExpense;
          break;
        }

        case 'mode3': {
          const tprRatio = targetProfitRate / 100;
          if (tprRatio > 0) {
            const funcMode3 = (tni) => {
              const tax = calculateSimulatedIncomeTax(tni);
              const ar = tni / tprRatio;
              const ani = ar - annualExp;
              return ani - (tax * 1.1);
            };

            taxBaseIncome = solveTNI(funcMode3, annualAfterTaxNetIncome);

            calculatedAnnualRevenue = taxBaseIncome / tprRatio;
            actualNetIncome = calculatedAnnualRevenue - annualExp;

            const annualReqExp = actualNetIncome - taxBaseIncome;
            calculatedMonthlyRequiredExpense = annualReqExp / 12;
          } else {
            calculatedAnnualRevenue = 0;
            calculatedMonthlyRequiredExpense = 0;
            taxBaseIncome = 0;
            actualNetIncome = 0;
          }
          calculatedTargetProfitRate = targetProfitRate;
          break;
        }

        case 'mode4': {
          actualNetIncome = annualRevenue - annualExp;
          taxBaseIncome = annualRevenue * (targetProfitRate / 100);

          const annualReqExp = actualNetIncome - taxBaseIncome;
          calculatedMonthlyRequiredExpense = annualReqExp / 12;

          calculatedAnnualRevenue = annualRevenue;
          calculatedTargetProfitRate = targetProfitRate;
          break;
        }

        case 'mode5': {
          actualNetIncome = annualRevenue - annualExp;
          const targetTaxBurden = actualNetIncome - annualAfterTaxNetIncome;

          if (targetTaxBurden > 0) {
            const funcMode5 = (tni) => calculateSimulatedIncomeTax(tni) * 1.1;
            taxBaseIncome = solveTNI(funcMode5, targetTaxBurden);
          } else {
            taxBaseIncome = actualNetIncome;
          }

          const annualReqExp = actualNetIncome - taxBaseIncome;
          calculatedMonthlyRequiredExpense = annualReqExp / 12;

          calculatedAnnualRevenue = annualRevenue;
          calculatedTargetProfitRate = (calculatedAnnualRevenue !== 0)
            ? (taxBaseIncome / calculatedAnnualRevenue) * 100
            : 0;
          break;
        }
      }

      const finalAnnualRev = Number.isFinite(calculatedAnnualRevenue) ? calculatedAnnualRevenue : 0;
      const finalMonthlyRev = finalAnnualRev / 12;

      const finalMonthlyReqExp = Number.isFinite(calculatedMonthlyRequiredExpense) ? calculatedMonthlyRequiredExpense : 0;
      const finalAnnualReqExp = finalMonthlyReqExp * 12;

      const annualTax = calculateSimulatedIncomeTax(taxBaseIncome);
      const annualLocalTax = annualTax * 0.1;
      const totalTaxBurden = annualTax + annualLocalTax;

      const annualPension = taxBaseIncome * 0.045;
      const annualInsurance = taxBaseIncome * 0.035;

      const actualProfitRate = (finalAnnualRev !== 0) ? (actualNetIncome / finalAnnualRev) * 100 : 0;
      const targetProfitRateCalculated = (finalAnnualRev !== 0) ? (taxBaseIncome / finalAnnualRev) * 100 : 0;

      const finalAnnualNetIncomePostTax = actualNetIncome - totalTaxBurden;
      const finalMonthlyNetIncomePostTax = finalAnnualNetIncomePostTax / 12;

      return {
        annualRev: finalAnnualRev,
        monthlyRev: finalMonthlyRev,
        annualExp: annualExp,
        monthlyExp: monthlyExpense,
        annualReqExp: finalAnnualReqExp,
        monthlyReqExp: finalMonthlyReqExp,

        actualProfitRate: actualProfitRate,
        targetProfitRate: targetProfitRateCalculated,

        annualNetIncome: finalAnnualNetIncomePostTax,
        monthlyNetIncome: finalMonthlyNetIncomePostTax,

        annualTax: annualTax,
        monthlyTax: annualTax / 12,

        annualPension: annualPension,
        monthlyPension: annualPension / 12,

        annualInsurance: annualInsurance,
        monthlyInsurance: annualInsurance / 12,
      };
    };

    /* =========================
       4) State / UI
    ========================= */
    const EMPTY_INPUTS = {
      annualRevenue: '',
      monthlyExpense: '',
      monthlyRequiredExpense: '',
      targetProfitRate: '',
      afterTaxNetIncome: '',
    };

    const state = {
      calculationMode: 'mode1',
      inputs: { ...EMPTY_INPUTS },
      lastCalculatedResults: null, // ê³„ì‚° ì „ null
      scenarios: [],
      simulationModes: [
        { id: 'mode1', label: '1. ì—°ë§¤ì¶œ & ì„¸í›„ìˆœì´ìµ ì‚°ì¶œ', desc: 'ì›”ì§€ì¶œ, ì›”í•„ìš”ê²½ë¹„, ëª©í‘œì†Œë“ë¥ ì„ ê¸°ë°˜ìœ¼ë¡œ ì—°ë§¤ì¶œ/ìˆœì´ìµì„ ì—­ì‚°í•©ë‹ˆë‹¤.', icon: 'ğŸ“ˆ' },
        { id: 'mode2', label: '2. ì—°ë§¤ì¶œ & ëª©í‘œì†Œë“ë¥  ì‚°ì¶œ', desc: 'í•„ìš”ê²½ë¹„/ì§€ì¶œ/ì„¸í›„ìˆœì´ìµ ê¸°ë°˜ìœ¼ë¡œ ëª©í‘œì†Œë“ë¥ /ë§¤ì¶œì„ ì—­ì‚°í•©ë‹ˆë‹¤.', icon: 'ğŸ“Š' },
        { id: 'mode3', label: '3. ì—°ë§¤ì¶œ & í•„ìš”ê²½ë¹„ ì‚°ì¶œ', desc: 'ì§€ì¶œ/ëª©í‘œì†Œë“ë¥ /ì„¸í›„ìˆœì´ìµ ê¸°ë°˜ìœ¼ë¡œ í•„ìš”ê²½ë¹„/ë§¤ì¶œì„ ì—­ì‚°í•©ë‹ˆë‹¤.', icon: 'ğŸ§®' },
        { id: 'mode4', label: '4. í•„ìš”ê²½ë¹„ & ì„¸í›„ìˆœì´ìµ ì‚°ì¶œ', desc: 'ì—°ë§¤ì¶œ/ì§€ì¶œ/ëª©í‘œì†Œë“ë¥  ê¸°ë°˜ìœ¼ë¡œ í•„ìš”ê²½ë¹„/ì„¸í›„ìˆœì´ìµì„ ì‚°ì¶œí•©ë‹ˆë‹¤.', icon: 'ğŸ’°' },
        { id: 'mode5', label: '5. í•„ìš”ê²½ë¹„ & ëª©í‘œì†Œë“ë¥  ì‚°ì¶œ', desc: 'ì—°ë§¤ì¶œ/ì§€ì¶œ/ì„¸í›„ìˆœì´ìµ ê¸°ë°˜ìœ¼ë¡œ í•„ìš”ê²½ë¹„/ëª©í‘œì†Œë“ë¥ ì„ ì—­ì‚°í•©ë‹ˆë‹¤.', icon: 'ğŸ¯' }
      ],
      iconMap: {
        TrendingUp: 'ğŸ“ˆ', PieChart: 'ğŸ“Š', Calculator: 'ğŸ§®',
        DollarSign: 'ğŸ’°', Target: 'ğŸ¯', FileText: 'ğŸ“„'
      },
      dom: {}
    };

    const getModeLabel = (mode) => {
      switch (mode) {
        case 'mode1': return '1. ì—°ë§¤ì¶œ & ì„¸í›„ìˆœì´ìµ ì‚°ì¶œ';
        case 'mode2': return '2. ì—°ë§¤ì¶œ & ëª©í‘œì†Œë“ë¥  ì‚°ì¶œ';
        case 'mode3': return '3. ì—°ë§¤ì¶œ & í•„ìš”ê²½ë¹„ ì‚°ì¶œ';
        case 'mode4': return '4. í•„ìš”ê²½ë¹„ & ì„¸í›„ìˆœì´ìµ ì‚°ì¶œ';
        case 'mode5': return '5. í•„ìš”ê²½ë¹„ & ëª©í‘œì†Œë“ë¥  ì‚°ì¶œ';
        default: return '';
      }
    };

    const isInputDisabled = (fieldName) => {
      const mode = state.calculationMode;
      switch (mode) {
        case 'mode1': return fieldName === 'annualRevenue' || fieldName === 'afterTaxNetIncome';
        case 'mode2': return fieldName === 'annualRevenue' || fieldName === 'targetProfitRate';
        case 'mode3': return fieldName === 'annualRevenue' || fieldName === 'monthlyRequiredExpense';
        case 'mode4': return fieldName === 'monthlyRequiredExpense' || fieldName === 'afterTaxNetIncome';
        case 'mode5': return fieldName === 'monthlyRequiredExpense' || fieldName === 'targetProfitRate';
        default: return false;
      }
    };

    /* =========================
       5) Render
    ========================= */
    const createDynamicResultCard = (title, annual, monthly, isPercentage, colorClass, icon) => {
      const annualValue = isPercentage
        ? (Number.isFinite(annual) ? annual.toFixed(1) : '0.0') + '%'
        : (typeof annual === 'number' ? formatCurrency(annual) : formatCurrency(0));

      const monthlyValue = (typeof monthly === 'number') ? formatCurrency(monthly) : formatCurrency(0);

      return `
        <div class="bg-white rounded-xl p-5 shadow-sm border border-slate-200 relative overflow-hidden">
          <div class="absolute top-0 right-0 p-2 rounded-bl-xl opacity-10 ${colorClass}">
            ${icon}
          </div>
          <h4 class="text-sm font-bold text-slate-500 mb-3 flex items-center gap-2">
            <span class="text-slate-400">${icon}</span> ${title}
            <span class="text-xs font-normal text-blue-600 bg-blue-50 px-2 py-0.5 rounded-full">ì‚°ì¶œê°’</span>
          </h4>
          <div class="space-y-3">
            ${!isPercentage ? `
              <div class="flex justify-between items-end border-b border-slate-100 pb-2">
                <span class="text-xs text-slate-400">ì—°ê°„</span>
                <span class="text-lg font-bold text-slate-800">${annualValue}</span>
              </div>
              <div class="flex justify-between items-end">
                <span class="text-xs text-slate-400">ì›”ê°„</span>
                <span class="text-lg font-bold text-slate-800">${monthlyValue}</span>
              </div>
            ` : `
              <div class="flex justify-between items-end pt-2">
                <span class="text-xs text-slate-400">ëª©í‘œ ë¹„ìœ¨</span>
                <span class="text-2xl font-bold text-slate-800">${annualValue}</span>
              </div>
            `}
          </div>
        </div>
      `;
    };

    const createFixedResultCard = (title, value1Label, value1, value2Label, value2, icon, colorText = "text-slate-800") => {
      if (title === 'ì†Œë“ë¥ ') {
        return `
          <div class="bg-slate-50 rounded-xl p-5 border border-slate-200">
            <h4 class="text-sm font-bold text-slate-500 mb-3 flex items-center gap-2">
              <span class="text-slate-400">${icon}</span> ${title}
              <span class="text-xs font-normal text-slate-400 bg-slate-200 px-2 py-0.5 rounded-full">ê³ ì •</span>
            </h4>
            <div class="space-y-3">
              <div class="flex justify-between items-center border-b border-slate-100 pb-2">
                <span class="text-xs text-slate-400">ì‹¤ì œì†Œë“ë¥ </span>
                <span class="text-lg font-bold text-slate-800">${value1}</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-xs text-slate-400">ëª©í‘œì†Œë“ë¥ </span>
                <span class="text-lg font-bold text-slate-800">${value2}</span>
              </div>
            </div>
          </div>
        `;
      }

      return `
        <div class="bg-slate-50 rounded-xl p-5 border border-slate-200">
          <h4 class="text-sm font-bold text-slate-500 mb-3 flex items-center gap-2">
            <span class="text-slate-400">${icon}</span> ${title}
            <span class="text-xs font-normal text-slate-400 bg-slate-200 px-2 py-0.5 rounded-full">ê³ ì •</span>
          </h4>
          <div class="space-y-3">
            <div class="flex justify-between items-center border-b border-slate-100 pb-2">
              <span class="text-xs text-slate-400">${value1Label}</span>
              <span class="text-lg font-bold ${colorText}">${value1}</span>
            </div>
            ${value2Label ? `
              <div class="flex justify-between items-center">
                <span class="text-xs text-slate-400">${value2Label}</span>
                <span class="text-lg font-bold ${colorText}">${value2}</span>
              </div>
            ` : ''}
          </div>
        </div>
      `;
    };

    const renderModeSelectors = () => {
      const container = state.dom.modeSelectors;
      container.innerHTML = state.simulationModes.map(mode => {
        const isActive = state.calculationMode === mode.id;
        const activeClass = isActive
          ? 'border-blue-600 bg-blue-50 ring-2 ring-blue-100 ring-offset-2 shadow-md'
          : 'border-slate-200 bg-white hover:border-blue-300 hover:bg-blue-50/30';

        const iconClass = isActive
          ? 'bg-blue-200 text-blue-700'
          : 'bg-slate-100 text-slate-500 group-hover:bg-blue-100 group-hover:text-blue-600';

        const labelClass = isActive ? 'text-blue-700' : 'text-slate-700';
        const indicator = isActive ? '<div class="h-2 w-2 rounded-full bg-blue-600 animate-pulse mt-1"></div>' : '';

        return `
          <button data-mode="${mode.id}" class="mode-btn relative p-4 rounded-xl border-2 text-left transition-all group ${activeClass}">
            <div class="flex justify-between items-start mb-2">
              <div class="flex items-center gap-2">
                <div class="p-1.5 rounded-lg ${iconClass}">${mode.icon}</div>
                <span class="font-bold text-sm ${labelClass}">${mode.label}</span>
              </div>
              ${indicator}
            </div>
            <p class="text-xs text-slate-500 pl-9">${mode.desc}</p>
          </button>
        `;
      }).join('');
    };

    const updateInputForm = () => {
      const r = state.lastCalculatedResults;
      const { annualRevenueInput, monthlyExpenseInput, monthlyRequiredExpenseInput, targetProfitRateInput, afterTaxNetIncomeInput } = state.dom;

      const map = [
        { name: 'annualRevenue', input: annualRevenueInput, isCurrency: true, resultKey: 'annualRev' },
        { name: 'monthlyExpense', input: monthlyExpenseInput, isCurrency: true, resultKey: null },
        { name: 'monthlyRequiredExpense', input: monthlyRequiredExpenseInput, isCurrency: true, resultKey: 'monthlyReqExp' },
        { name: 'targetProfitRate', input: targetProfitRateInput, isCurrency: false, resultKey: 'targetProfitRate' },
        { name: 'afterTaxNetIncome', input: afterTaxNetIncomeInput, isCurrency: true, resultKey: 'monthlyNetIncome' },
      ];

      map.forEach(({ name, input, isCurrency, resultKey }) => {
        const disabled = isInputDisabled(name);
        const label = input.closest('div.space-y-5 > div')?.querySelector('label');
        const statusLabelSpan = label ? label.querySelector('span') : null;

        const disabledClasses = 'bg-slate-100 border-slate-200 text-slate-400 cursor-not-allowed';
        const activeClasses = 'bg-white border-slate-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500';

        input.classList.remove(...disabledClasses.split(' '), ...activeClasses.split(' '));

        if (disabled) {
          input.disabled = true;
          input.classList.add(...disabledClasses.split(' '));
          if (statusLabelSpan) statusLabelSpan.style.display = 'inline';

          if (!r) {
            input.value = '';
            input.placeholder = 'ê³„ì‚°í•˜ê¸°ë¥¼ ëˆ„ë¥´ë©´ ì‚°ì¶œ';
          } else {
            const v = r[resultKey];
            if (isCurrency) input.value = Math.round(v || 0).toLocaleString('ko-KR');
            else input.value = Number(v || 0).toFixed(2);
            input.placeholder = 'ìë™ ì‚°ì¶œ';
          }
        } else {
          input.disabled = false;
          input.classList.add(...activeClasses.split(' '));
          if (statusLabelSpan) statusLabelSpan.style.display = 'none';

          // ê³„ì‚° ê²°ê³¼ê°€ ìˆì–´ë„ ì‚¬ìš©ìê°€ ì…ë ¥í•˜ëŠ” ê°’ì€ ìœ ì§€
          if (document.activeElement !== input) {
            const raw = state.inputs[name];
            if (isCurrency) {
              const n = toNum(raw);
              input.value = raw === '' ? '' : (n ? n.toLocaleString('ko-KR') : '');
            } else {
              input.value = raw === '' ? '' : String(toNum(raw));
            }
          }
          input.placeholder = '0';
        }
      });
    };

    const renderDashboard = () => {
      const r = state.lastCalculatedResults;
      const cards = state.dom.dashboardCards;

      if (!r) {
        cards.innerHTML = `
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            ${createDynamicResultCard("ì˜ˆìƒ ë§¤ì¶œ", 0, 0, false, "bg-emerald-500", state.iconMap.TrendingUp)}
            ${createDynamicResultCard("ì˜ˆìƒ ì„¸í›„ìˆœì´ìµ", 0, 0, false, "bg-blue-500", state.iconMap.DollarSign)}
          </div>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            ${createFixedResultCard("ì†Œë“ë¥ ", null, "0.0%", null, "0.0%", state.iconMap.PieChart, "text-indigo-600")}
            ${createFixedResultCard("ì¢…í•©ì†Œë“ì„¸", "ì—°ê°„", formatCurrency(0), "ì›”ê°„", formatCurrency(0), state.iconMap.FileText)}
          </div>
        `;
        state.dom.dashboardInsightMode.textContent = getModeLabel(state.calculationMode).split('.')[1].trim();
        state.dom.dashboardInsightText.innerHTML = `ì•„ì§ ê³„ì‚° ì „ì…ë‹ˆë‹¤. <strong>ğŸ§® ê³„ì‚°í•˜ê¸°</strong>ë¥¼ ëˆ„ë¥´ë©´ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤.`;
        return;
      }

      const { annualRev, monthlyRev, annualReqExp, monthlyReqExp, targetProfitRate, annualNetIncome, monthlyNetIncome, actualProfitRate, annualTax } = r;

      let card1 = '';
      let card2 = '';
      switch (state.calculationMode) {
        case 'mode1':
          card1 = createDynamicResultCard("ì˜ˆìƒ ë§¤ì¶œ", annualRev, monthlyRev, false, "bg-emerald-500", state.iconMap.TrendingUp);
          card2 = createDynamicResultCard("ì˜ˆìƒ ì„¸í›„ìˆœì´ìµ", annualNetIncome, monthlyNetIncome, false, "bg-blue-500", state.iconMap.DollarSign);
          break;
        case 'mode2':
          card1 = createDynamicResultCard("ì˜ˆìƒ ë§¤ì¶œ", annualRev, monthlyRev, false, "bg-emerald-500", state.iconMap.TrendingUp);
          card2 = createDynamicResultCard("ëª©í‘œì†Œë“ë¥ ", targetProfitRate, 0, true, "bg-purple-500", state.iconMap.Target);
          break;
        case 'mode3':
          card1 = createDynamicResultCard("ì˜ˆìƒ ë§¤ì¶œ", annualRev, monthlyRev, false, "bg-emerald-500", state.iconMap.TrendingUp);
          card2 = createDynamicResultCard("í•„ìš”ê²½ë¹„", annualReqExp, monthlyReqExp, false, "bg-orange-500", state.iconMap.Calculator);
          break;
        case 'mode4':
          card1 = createDynamicResultCard("í•„ìš”ê²½ë¹„", annualReqExp, monthlyReqExp, false, "bg-orange-500", state.iconMap.Calculator);
          card2 = createDynamicResultCard("ì˜ˆìƒ ì„¸í›„ìˆœì´ìµ", annualNetIncome, monthlyNetIncome, false, "bg-blue-500", state.iconMap.DollarSign);
          break;
        case 'mode5':
          card1 = createDynamicResultCard("í•„ìš”ê²½ë¹„", annualReqExp, monthlyReqExp, false, "bg-orange-500", state.iconMap.Calculator);
          card2 = createDynamicResultCard("ëª©í‘œì†Œë“ë¥ ", targetProfitRate, 0, true, "bg-purple-500", state.iconMap.Target);
          break;
      }

      const fixedCardsHtml = `
        ${createFixedResultCard("ì†Œë“ë¥ ", null, `${formatRate1(actualProfitRate)}%`, null, `${formatRate1(targetProfitRate)}%`, state.iconMap.PieChart, "text-indigo-600")}
        ${createFixedResultCard("ì¢…í•©ì†Œë“ì„¸", "ì—°ê°„", formatCurrency(annualTax), "ì›”ê°„", formatCurrency(annualTax / 12), state.iconMap.FileText)}
      `;

      cards.innerHTML = `
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">${card1 + card2}</div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">${fixedCardsHtml}</div>
      `;

      const industryAvg = 40;
      const diff = industryAvg - actualProfitRate;
      const diffText = diff > 0 ? 'ë‚®ìŠµë‹ˆë‹¤' : 'ë†’ìŠµë‹ˆë‹¤';

      state.dom.dashboardInsightMode.textContent = getModeLabel(state.calculationMode).split('.')[1].trim();
      state.dom.dashboardInsightText.innerHTML = `
        í˜„ì¬ ì†Œë“ë¥ (<strong>${formatRate1(actualProfitRate)}%</strong>)ì€ ë™ì¢… ì—…ê³„ í‰ê· (${industryAvg}%) ëŒ€ë¹„
        <strong>${Math.abs(diff).toFixed(1)}%</strong> ${diffText}.<br/>
        í•„ìš”ê²½ë¹„ë¥¼ <strong>â‚©${formatCompactCurrency(monthlyReqExp)}</strong>ìœ¼ë¡œ ìœ ì§€í•  ê²½ìš°,
        ëª©í‘œ ì†Œë“ë¥  ë‹¬ì„±ì„ ìœ„í•´ ì—°ë§¤ì¶œ <strong>â‚©${formatCompactCurrency(annualRev)}</strong>ì´ í•„ìš”í•©ë‹ˆë‹¤.
      `;
    };

    const renderScenarioTable = () => {
      const tbody = state.dom.scenarioTableBody;

      if (state.scenarios.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="18" class="px-6 py-12 text-center text-slate-400 bg-slate-50/30">
              ì…ë ¥ í›„ <strong>ğŸ§® ê³„ì‚°í•˜ê¸°</strong>ë¥¼ ëˆŒëŸ¬ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”.
            </td>
          </tr>
        `;
        return;
      }

      tbody.innerHTML = state.scenarios.map((item, idx) => `
        <tr class="hover:bg-slate-50/80 transition-colors">
          <td class="px-3 py-3 text-center font-medium text-slate-400 border-r border-slate-100 sticky sticky-col sticky-col-1 bg-white z-10">${idx + 1}</td>

          <td class="px-4 py-3 text-center border-r border-slate-100 sticky sticky-col sticky-col-2 bg-white z-10">
            <span class="px-2 py-0.5 rounded-full text-[10px] font-medium bg-slate-100 text-slate-600 truncate block w-24 mx-auto">
              ${item.mode.split('.')[0]} ì‹œë‚˜ë¦¬ì˜¤
            </span>
          </td>

          <td class="px-4 py-3 text-center text-blue-700 font-bold bg-blue-50/30 border-r border-slate-100">${formatRate1(item.actualProfitRate)}%</td>
          <td class="px-4 py-3 text-center text-blue-600 bg-blue-50/30 border-r border-slate-100">${formatRate1(item.targetProfitRate)}%</td>

          <td class="px-2 py-3 text-right text-slate-700 font-medium bg-slate-50/30 border-r border-slate-100">${formatCompactCurrency(item.annualRev)}</td>
          <td class="px-2 py-3 text-right text-slate-700 bg-slate-50/30 border-r border-slate-100">${formatCompactCurrency(item.monthlyRev)}</td>

          <td class="px-2 py-3 text-right text-slate-700 bg-slate-50/30 border-r border-slate-100">${formatCompactCurrency(item.annualExp)}</td>
          <td class="px-2 py-3 text-right text-slate-700 bg-slate-50/30 border-r border-slate-100">${formatCompactCurrency(item.monthlyExp)}</td>

          <td class="px-2 py-3 text-right text-slate-700 bg-slate-50/30 border-r border-slate-100">${formatCompactCurrency(item.annualReqExp)}</td>
          <td class="px-2 py-3 text-right text-slate-700 bg-slate-50/30 border-r border-slate-100">${formatCompactCurrency(item.monthlyReqExp)}</td>

          <td class="px-2 py-3 text-right font-bold text-blue-700 bg-blue-50/30 border-r border-slate-100">${formatCompactCurrency(item.annualNetIncome)}</td>
          <td class="px-2 py-3 text-right font-bold text-blue-700 bg-blue-50/30 border-r border-slate-100">${formatCompactCurrency(item.monthlyNetIncome)}</td>

          <td class="px-2 py-3 text-right text-slate-500 border-r border-slate-100">${formatCompactCurrency(item.annualTax)}</td>
          <td class="px-2 py-3 text-right text-slate-500 border-r border-slate-100">${formatCompactCurrency(item.monthlyTax)}</td>

          <td class="px-2 py-3 text-right text-slate-500 border-r border-slate-100">${formatCompactCurrency(item.annualPension)}</td>
          <td class="px-2 py-3 text-right text-slate-500 border-r border-slate-100">${formatCompactCurrency(item.monthlyPension)}</td>

          <td class="px-2 py-3 text-right text-slate-500 border-r border-slate-100">${formatCompactCurrency(item.annualInsurance)}</td>
          <td class="px-2 py-3 text-right text-slate-500 border-r border-slate-100">${formatCompactCurrency(item.monthlyInsurance)}</td>

          <td class="px-3 py-3 text-center">
            <button class="remove-btn text-slate-400 hover:text-red-500 transition-colors p-1" data-id="${item.id}">ğŸ—‘ï¸</button>
          </td>
        </tr>
      `).join('');
    };

    const renderApp = () => {
      renderModeSelectors();
      updateInputForm();
      renderDashboard();
      renderScenarioTable();
    };

    /* =========================
       6) Actions
    ========================= */
    const setCalculationMode = (modeId) => {
      state.calculationMode = modeId;
      updateInputForm();
      renderModeSelectors();
      renderDashboard();
    };

    const handleAddScenario = () => {
      const results = calculateResults(state.inputs, state.calculationMode);
      state.lastCalculatedResults = results;

      const newId = state.scenarios.length > 0 ? Math.max(...state.scenarios.map(s => s.id)) + 1 : 1;
      state.scenarios.push({ id: newId, mode: getModeLabel(state.calculationMode), ...results });

      renderApp();
    };

    const handleRemoveScenario = (id) => {
      state.scenarios = state.scenarios.filter(s => s.id !== id);
      renderScenarioTable();
    };

    const handleResetInputs = () => {
      state.inputs = { ...EMPTY_INPUTS };
      state.lastCalculatedResults = null;
      renderApp();
    };

    const handleClearScenarios = () => {
      state.scenarios = [];
      renderScenarioTable();
    };

    /* =========================
       7) âœ… Excel Export
    ========================= */
    const exportScenariosToExcel = () => {
      if (!window.XLSX) {
        alert('ì—‘ì…€ ëª¨ë“ˆ(SheetJS)ì´ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
        return;
      }
      if (!state.scenarios.length) {
        alert('ë‹¤ìš´ë¡œë“œí•  ì‹œë‚˜ë¦¬ì˜¤ê°€ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì¶”ê°€í•˜ì„¸ìš”.');
        return;
      }

      const header = [
        'No', 'êµ¬ë¶„(ëª¨ë“œ)',
        'ì‹¤ì œì†Œë“ë¥ (%)', 'ëª©í‘œì†Œë“ë¥ (%)',
        'ì—°ë§¤ì¶œ', 'ì›”ë§¤ì¶œ',
        'ì—°ì§€ì¶œ', 'ì›”ì§€ì¶œ',
        'ì—°í•„ìš”ê²½ë¹„', 'ì›”í•„ìš”ê²½ë¹„',
        'ì—°ì„¸í›„ìˆœì´ìµ', 'ì›”ì„¸í›„ìˆœì´ìµ',
        'ì—°ì¢…í•©ì†Œë“ì„¸', 'ì›”ì¢…í•©ì†Œë“ì„¸',
        'ì—°êµ­ë¯¼ì—°ê¸ˆ', 'ì›”êµ­ë¯¼ì—°ê¸ˆ',
        'ì—°ê±´ê°•ë³´í—˜ë£Œ', 'ì›”ê±´ê°•ë³´í—˜ë£Œ'
      ];

      const rows = state.scenarios.map((s, i) => ([
        i + 1,
        s.mode,
        Number(formatRate1(s.actualProfitRate)),
        Number(formatRate1(s.targetProfitRate)),
        Math.round(s.annualRev),
        Math.round(s.monthlyRev),
        Math.round(s.annualExp),
        Math.round(s.monthlyExp),
        Math.round(s.annualReqExp),
        Math.round(s.monthlyReqExp),
        Math.round(s.annualNetIncome),
        Math.round(s.monthlyNetIncome),
        Math.round(s.annualTax),
        Math.round(s.monthlyTax),
        Math.round(s.annualPension),
        Math.round(s.monthlyPension),
        Math.round(s.annualInsurance),
        Math.round(s.monthlyInsurance),
      ]));

      const aoa = [header, ...rows];
      const ws = XLSX.utils.aoa_to_sheet(aoa);

      // ë³´ê¸° ì¢‹ê²Œ ì—´ ë„ˆë¹„
      ws['!cols'] = [
        { wch: 5 }, { wch: 24 },
        { wch: 14 }, { wch: 14 },
        { wch: 14 }, { wch: 14 },
        { wch: 14 }, { wch: 14 },
        { wch: 14 }, { wch: 14 },
        { wch: 16 }, { wch: 16 },
        { wch: 14 }, { wch: 14 },
        { wch: 14 }, { wch: 14 },
        { wch: 14 }, { wch: 14 },
      ];

      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, 'Scenarios');

      const now = new Date();
      const y = now.getFullYear();
      const m = String(now.getMonth() + 1).padStart(2, '0');
      const d = String(now.getDate()).padStart(2, '0');
      const filename = `Pro-Consulting-Scenarios_${y}${m}${d}.xlsx`;

      XLSX.writeFile(wb, filename);
    };

    /* =========================
       8) Boot
    ========================= */
    window.addEventListener('load', () => {
      state.dom = {
        modeSelectors: document.getElementById('mode-selectors'),
        dashboardCards: document.getElementById('dashboard-cards'),
        dashboardInsightMode: document.getElementById('dashboard-insight-mode'),
        dashboardInsightText: document.getElementById('dashboard-insight-text'),
        scenarioTableBody: document.getElementById('scenario-table-body'),

        annualRevenueInput: document.querySelector('[name="annualRevenue"]'),
        monthlyExpenseInput: document.querySelector('[name="monthlyExpense"]'),
        monthlyRequiredExpenseInput: document.querySelector('[name="monthlyRequiredExpense"]'),
        targetProfitRateInput: document.querySelector('[name="targetProfitRate"]'),
        afterTaxNetIncomeInput: document.querySelector('[name="afterTaxNetIncome"]'),

        addScenarioBtn: document.getElementById('add-scenario-btn'),
        resetInputsBtn: document.getElementById('reset-inputs-btn'),
        headerResetBtn: document.getElementById('header-reset-btn'),
        clearScenariosBtn: document.getElementById('clear-scenarios-btn'),
        excelBtn: document.getElementById('excel-download-btn'),
      };

      // âœ… í†µí™” ì…ë ¥: ì…ë ¥ ì¤‘ ìë™ ì½¤ë§ˆ + state.inputs ì—…ë°ì´íŠ¸
      const bindCurrencyLiveComma = (inputEl, key) => {
        inputEl.addEventListener('input', (e) => {
          if (inputEl.disabled) return;
          formatNumberInputWithComma(inputEl);
          state.inputs[key] = inputEl.value; // ì½¤ë§ˆ í¬í•¨ ë¬¸ìì—´ ì €ì¥
        });
        inputEl.addEventListener('blur', () => {
          if (inputEl.disabled) return;
          const n = toNum(inputEl.value);
          inputEl.value = n ? n.toLocaleString('ko-KR') : '';
          state.inputs[key] = inputEl.value;
        });
      };

      bindCurrencyLiveComma(state.dom.annualRevenueInput, 'annualRevenue');
      bindCurrencyLiveComma(state.dom.monthlyExpenseInput, 'monthlyExpense');
      bindCurrencyLiveComma(state.dom.monthlyRequiredExpenseInput, 'monthlyRequiredExpense');
      bindCurrencyLiveComma(state.dom.afterTaxNetIncomeInput, 'afterTaxNetIncome');

      state.dom.targetProfitRateInput.addEventListener('input', (e) => {
        if (state.dom.targetProfitRateInput.disabled) return;
        state.inputs.targetProfitRate = e.target.value;
      });

      state.dom.addScenarioBtn.addEventListener('click', handleAddScenario);
      state.dom.resetInputsBtn.addEventListener('click', handleResetInputs);
      state.dom.headerResetBtn.addEventListener('click', handleResetInputs);
      state.dom.clearScenariosBtn.addEventListener('click', handleClearScenarios);
      state.dom.excelBtn.addEventListener('click', exportScenariosToExcel);

      document.addEventListener('click', (e) => {
        const modeBtn = e.target.closest('.mode-btn');
        if (modeBtn) {
          setCalculationMode(modeBtn.getAttribute('data-mode'));
          return;
        }
        const removeBtn = e.target.closest('.remove-btn');
        if (removeBtn) {
          const id = toNum(removeBtn.getAttribute('data-id'));
          handleRemoveScenario(id);
          return;
        }
      });

      renderApp();
    });
  </script>
</head>

<body class="min-h-screen bg-slate-50 font-sans text-slate-900">
  <div id="app-root">

    <header class="bg-white border-b border-slate-200 sticky top-0 z-30">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
        <div class="flex items-center gap-2">
          <div class="bg-blue-600 p-2 rounded-lg">ğŸ§®</div>
          <h1 class="text-xl font-bold text-slate-800 tracking-tight">Pro-Consulting Lab</h1>
        </div>
        <div class="flex items-center gap-3">
          <button id="header-reset-btn" class="text-sm text-slate-500 hover:text-slate-800 px-3 py-2 flex items-center gap-1 transition-colors rounded-lg">
            ğŸ”„ ì´ˆê¸°í™”
          </button>
          <button class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2 shadow-sm transition-colors">
            ğŸ’¾ ë°ì´í„° ì €ì¥
          </button>
        </div>
      </div>
    </header>

    <main class="max-w-[1800px] mx-auto px-4 sm:px-6 lg:px-8 py-8">

      <section class="mb-8">
        <h2 class="text-lg font-semibold mb-4 flex items-center gap-2">ğŸ’¡ ì‹œë®¬ë ˆì´ì…˜ ê¸°ì¤€ ì„¤ì •</h2>
        <div id="mode-selectors" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4"></div>
      </section>

      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-10">
        <div class="lg:col-span-1 bg-white rounded-2xl shadow-xl border border-slate-200 p-6">
          <div class="flex justify-between items-center mb-6">
            <h3 class="font-bold text-lg text-slate-800">ê¸°ì´ˆ ë°ì´í„° ì…ë ¥</h3>
            <span class="text-xs font-medium px-2 py-1 bg-slate-100 rounded text-slate-500">ë‹¨ìœ„: ì›</span>
          </div>

          <div class="space-y-5" id="input-form">
            <div>
              <label class="block text-sm font-medium text-slate-700 mb-1.5 flex justify-between">
                ì—°ë§¤ì¶œ
                <span style="display: none;" class="text-xs text-blue-500 font-normal self-center">ìë™ ì‚°ì¶œë¨</span>
              </label>
              <input type="text" name="annualRevenue" placeholder="0" class="w-full px-4 py-2.5 rounded-lg border transition-colors" />
            </div>

            <div>
              <label class="block text-sm font-medium text-slate-700 mb-1.5">ì›”ì§€ì¶œ</label>
              <input type="text" name="monthlyExpense" placeholder="0" class="w-full px-4 py-2.5 rounded-lg border transition-colors" />
            </div>

            <div>
              <label class="block text-sm font-medium text-slate-700 mb-1.5 flex justify-between">
                ì›”í•„ìš”ê²½ë¹„
                <span style="display: none;" class="text-xs text-blue-500 font-normal self-center">ìë™ ì‚°ì¶œë¨</span>
              </label>
              <input type="text" name="monthlyRequiredExpense" placeholder="0" class="w-full px-4 py-2.5 rounded-lg border transition-colors" />
            </div>

            <div>
              <label class="block text-sm font-medium text-slate-700 mb-1.5 flex justify-between">
                ëª©í‘œì†Œë“ë¥  (%)
                <span style="display: none;" class="text-xs text-blue-500 font-normal self-center">ìë™ ì‚°ì¶œë¨</span>
              </label>
              <div class="relative">
                <input type="number" name="targetProfitRate" step="0.1" placeholder="0" class="w-full px-4 py-2.5 rounded-lg border transition-colors pr-8" />
                <span class="absolute right-3 top-2.5 text-slate-400">%</span>
              </div>
            </div>

            <div>
              <label class="block text-sm font-medium text-slate-700 mb-1.5 flex justify-between">
                ì„¸í›„ì›”ìˆœì´ìµ
                <span style="display: none;" class="text-xs text-blue-500 font-normal self-center">ìë™ ì‚°ì¶œë¨</span>
              </label>
              <input type="text" name="afterTaxNetIncome" placeholder="0" class="w-full px-4 py-2.5 rounded-lg border transition-colors" />
            </div>

            <div class="grid grid-cols-2 gap-3 mt-8 pt-4 border-t border-slate-100">
              <button id="add-scenario-btn" class="bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-xl font-semibold shadow-lg shadow-blue-200 transition-all flex items-center justify-center gap-2 transform hover:scale-[1.02] active:scale-100">
                ğŸ§® ê³„ì‚°í•˜ê¸°
              </button>
              <button id="reset-inputs-btn" class="bg-white border border-slate-300 hover:bg-slate-50 text-slate-700 py-3 rounded-xl font-semibold transition-all flex items-center justify-center gap-2">
                ğŸ”„ ì…ë ¥ ì´ˆê¸°í™”
              </button>
            </div>
          </div>
        </div>

        <div class="lg:col-span-2 space-y-6">
          <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2">â¡ï¸ ì‹¤ì‹œê°„ ë¶„ì„ ëŒ€ì‹œë³´ë“œ</h3>
          <div id="dashboard-cards" class="space-y-4"></div>

          <div class="bg-amber-50 border border-amber-200 rounded-xl p-4 flex items-start gap-3">
            <div class="p-1 bg-amber-100 rounded text-amber-600 mt-1">ğŸ“ˆ</div>
            <div>
              <h4 class="text-sm font-bold text-amber-800">ì»¨ì„¤íŒ… ì¸ì‚¬ì´íŠ¸ (<span id="dashboard-insight-mode"></span>)</h4>
              <p class="text-sm text-amber-700 mt-1 leading-relaxed" id="dashboard-insight-text"></p>
            </div>
          </div>
        </div>
      </div>

      <div class="bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden">
        <div class="p-5 border-b border-slate-200 flex justify-between items-center bg-slate-50/50">
          <h3 class="font-bold text-lg text-slate-800 flex items-center gap-2">ğŸ“„ ì‹œë‚˜ë¦¬ì˜¤ ë¹„êµ ë¶„ì„</h3>
          <div class="flex gap-2">
            <!-- âœ… id ì¶”ê°€ -->
            <button id="excel-download-btn" class="text-xs font-medium bg-white border border-slate-300 px-3 py-1.5 rounded-lg hover:bg-slate-50 transition-colors">
              Excel ë‹¤ìš´ë¡œë“œ
            </button>
            <button id="clear-scenarios-btn" class="text-xs font-medium bg-white border border-slate-300 px-3 py-1.5 rounded-lg hover:bg-red-50 transition-colors text-red-500 border-red-200">
              ğŸ—‘ï¸ ì „ì²´ ì‚­ì œ
            </button>
          </div>
        </div>

        <div class="table-container">
          <table class="w-full text-xs text-left border-collapse">
            <thead class="bg-slate-50 text-slate-600 font-semibold border-b border-slate-200 sticky top-0 z-20">
              <tr>
                <th rowspan="2" class="px-3 py-4 whitespace-nowrap text-center border-r border-slate-200 sticky sticky-col sticky-col-1 bg-slate-50 z-20">No</th>
                <th rowspan="2" class="px-4 py-4 whitespace-nowrap text-center border-r border-slate-200 sticky sticky-col sticky-col-2 bg-slate-50 z-20">êµ¬ë¶„</th>

                <th colspan="2" class="px-2 py-2 whitespace-nowrap text-center border-r border-slate-200 bg-blue-50 text-blue-800">ì†Œë“ë¥ </th>

                <th colspan="2" class="px-2 py-2 whitespace-nowrap text-center border-r border-slate-200 bg-slate-100 text-slate-800">ë§¤ì¶œ</th>
                <th colspan="2" class="px-2 py-2 whitespace-nowrap text-center border-r border-slate-200 bg-slate-100 text-slate-800">ì§€ì¶œ</th>
                <th colspan="2" class="px-2 py-2 whitespace-nowrap text-center border-r border-slate-200 bg-slate-100 text-slate-800">í•„ìš” ê²½ë¹„</th>

                <th colspan="2" class="px-2 py-2 whitespace-nowrap text-center border-r border-slate-200 bg-blue-50 text-blue-800">ì„¸í›„ìˆœì´ìµ</th>

                <th colspan="2" class="px-2 py-2 whitespace-nowrap text-center border-r border-slate-200">ì¢…í•©ì†Œë“ì„¸</th>
                <th colspan="2" class="px-2 py-2 whitespace-nowrap text-center border-r border-slate-200">êµ­ë¯¼ì—°ê¸ˆ</th>
                <th colspan="2" class="px-2 py-2 whitespace-nowrap text-center border-r border-slate-200">ê±´ê°•ë³´í—˜ë£Œ</th>
                <th rowspan="2" class="px-3 py-4 text-center">ê´€ë¦¬</th>
              </tr>
              <tr class="bg-slate-50/50 text-[11px] text-slate-500">
                <th class="px-4 py-2 text-center border-r border-slate-200 bg-blue-50/50 text-blue-800">ì‹¤ì œ</th>
                <th class="px-4 py-2 text-center border-r border-slate-200 bg-blue-50/50 text-blue-800">ëª©í‘œ</th>

                <th class="px-2 py-2 text-center border-r border-slate-200 bg-slate-100/50 text-slate-800">ì—°ê°„</th>
                <th class="px-2 py-2 text-center border-r border-slate-200 bg-slate-100/50 text-slate-800">ì›”ê°„</th>

                <th class="px-2 py-2 text-center border-r border-slate-200 bg-slate-100/50 text-slate-800">ì—°ê°„</th>
                <th class="px-2 py-2 text-center border-r border-slate-200 bg-slate-100/50 text-slate-800">ì›”ê°„</th>

                <th class="px-2 py-2 text-center border-r border-slate-200 bg-slate-100/50 text-slate-800">ì—°ê°„</th>
                <th class="px-2 py-2 text-center border-r border-slate-200 bg-slate-100/50 text-slate-800">ì›”ê°„</th>

                <th class="px-2 py-2 text-center border-r border-slate-200 bg-blue-50/50 text-blue-800">ì—°ê°„</th>
                <th class="px-2 py-2 text-center border-r border-slate-200 bg-blue-50/50 text-blue-800">ì›”ê°„</th>

                <th class="px-2 py-2 text-center border-r border-slate-200">ì—°ê°„</th>
                <th class="px-2 py-2 text-center border-r border-slate-200">ì›”ê°„</th>

                <th class="px-2 py-2 text-center border-r border-slate-200">ì—°ê°„</th>
                <th class="px-2 py-2 text-center border-r border-slate-200">ì›”ê°„</th>

                <th class="px-2 py-2 text-center border-r border-slate-200">ì—°ê°„</th>
                <th class="px-2 py-2 text-center border-r border-slate-200">ì›”ê°„</th>
              </tr>
            </thead>
            <tbody id="scenario-table-body" class="divide-y divide-slate-100"></tbody>
          </table>
        </div>
      </div>
    </main>
  </div>
</body>
</html>
